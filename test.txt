# 과제명:  데이터분석 과제6  - 필터링, 열 재배열, 시간값 행 인덱스
# 작성자: 20183323 손지노
# 어려웠던 점 (있으면) : 없었습니다.

import pandas as pd
# 파일 열기
open_file = pd.read_csv('./2017_10_07_AIS_RAW_5to6.csv')

# 필터링후 필터링된 값 저장
new = (open_file.SOG > 0) & ((open_file.HDG >=0) & (open_file.HDG <=360))
df = open_file.loc[new, ['MMSI', 'Longitude', 'Latitude', 'Date', 'Time']]

#Date와 Time 열의 문자열 데이터 더한 후 DateTime열로 추가
df['DateTime'] = df['Date'] + ' ' + df['Time']

# Date와 Time열 삭제
df.drop('Date', axis=1, inplace=True)
df.drop('Time', axis=1, inplace=True)

# DateTime을 Timestamp데이터로 변환 후 df정보 출력
df['DateTime'] = pd.to_datetime(df['DateTime'])
print(df.info())

#DateTime을 인덱스로 설정
df.set_index('DateTime', inplace=True)
print(df)